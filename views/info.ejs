<!DOCTYPE html>
<html lang="en">
	<head>
    <% include partials/head %>
	</head>
	<body data-spy="scroll" data-target="#pb-navbar" data-offset="200">

    <nav class="navbar navbar-expand-lg navbar-dark pb_navbar pb_scrolled-light" id="pb-navbar">
      <div class="container">
        <a class="navbar-brand" href="/">GratitudeToday.io</a>
        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#probootstrap-navbar" aria-controls="probootstrap-navbar" aria-expanded="false" aria-label="Toggle navigation">
          <span><i class="ion-navicon"></i></span>
        </button>
        <div class="collapse navbar-collapse" id="probootstrap-navbar">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="#section-home">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="#recent-posts">Recent Posts</a></li>
            
          </ul>
        </div>
      </div>
    </nav>
    <!-- END nav -->




    <section class="pb_cover_v3 overflow-hidden text-left"  id="section-home">
      <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="row align-items-center justify-content-center"></div>
            <div class="col-md-6">
                <div class="wrapper"  id="slide">
                  <h2 class="heading mb-3 quote-title main-title" style="padding-top:130px !important">“Gratitude turns what we have into enough.” ~ Anonymous</h2>
                   
                  </div>
           
            
        
          </div>
          <div class="col-md-5 relative align-self-center" style="padding-top:100px !important;">
              
            
            <form class="needs-validation bg-white rounded pb_form_v1" id="updateUserInfo" novalidate>
            
              <h2 class="mb-4 mt-0 text-center">Welcome <span id="name"></span>!</h2><p class="text-center">Don't worry, you can do this later.</p>
             
              
              <div class="form-group">

                <textarea class="form-control z-depth-1" id="bio" rows="5" placeholder="Tell us a little about yourself..."></textarea>
                
              </div>
              <div class="form-group">
                  <input type="text" class="form-control" id="address" placeholder="Address..." >
                
              </div>
              
        
              
                  <div class="form-group">
                      <input type="submit" class="btn btn-info" id="btn_skip" value="Skip">
                      <input type="submit" class="btn btn-success" value="Update">
                      
                     
                    </div>
              
               
            </form>

    </div>
  </div>
      </div>
    </section>
    <!-- END section -->
      
    <% include partials/footer %>

    <% include partials/scripts %>
    
    <style>
        .wrapper {
   position: relative;
   /* overflow: hidden; */
   width: 100px;
   height: 100px; 
   margin-top:-250px;
   padding-top: 50px;
    /* border: 1px solid black;  */
}

#slide {
   position: absolute;
   left: -800px;
   width: 100%;
   height: 100px;
   
   -webkit-animation: slide 0.5s forwards;
   -webkit-animation-delay: 2s;
   animation: slide 0.5s forwards;
   animation-delay: 2s;
}

@-webkit-keyframes slide {
   100% { left: 0; }
}

@keyframes slide {
   100% { left: 0; }
}
   </style> 
<script>
    $(document).ready(function() {
      
    var _id=($.urlParam('id'));
    
   var passId;
      console.log("id: "+_id);
      //call get user
      $.ajax({
          url: '/users/'+_id,
          type: "GET",
          dataType: "json",
          data: {id: _id},
            success: function(data, textStatus, jqXHR) {
                   //set first name, lastname, email, avatar 
                   
                    $("#name").html(data.firstname+" "+data.lastname);
                    passId=data._id;
                   
            },
            error: function(jqXHR, textStatus, errorThrown) {
                    console.log('Error occurred on info.ejs');
                    
            }
        }); 
        $("#btn_skip").click(function() {
            event.preventDefault();
            window.location.assign("/profile/?id="+passId);
            
        });
        $("#updateUserInfo").submit(function(event) {
          // Prevent the form from submitting via the browser.
          console.log("update button clicked");
          event.preventDefault();

          // PREPARE FORM DATA
          console.log('create form data: '+passId);
            var formData = {
               
               
               location :  $("#location").val(),
               bio: $("#location").val(),
               avatar:"/images/coverphotos/profile.jpg"
            }
            console.log('call ajax');
            
            $.ajax({
                  type : "PUT",
                  data : {location:location,bio:bio,avatar:'/images/coverphotos/profile.jpg'},
                  contentType : "application/json",
                  url : "/info/?id="+passId,
                  success : function(customer) {
                      //forward page with id to fill in optional information
                      console.log("id : "+customer._id);
                    window.location.assign("/info/?id="+customer._id);
                    
                  },
                  error : function(error) {
                      console.log(error);
                      if(error.status==410){
                         $(".err-msg").html("Error.");
                        $(".err-msg").show(); 
                      }
                  }
               });
               console.log('past ajax');
    	
            
         });
        
        });
            
    
</script>

    
	</body>
</html>





