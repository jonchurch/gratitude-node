<!DOCTYPE html>
<html lang="en">
	<head><% include partials/head %>
	</head>
	<body data-spy="scroll" data-target="#pb-navbar" data-offset="200"><% include partials/nav %>
		<!-- END nav -->
	<section class="pb_cover_v3 overflow-hidden text-left"  id="section-home">
			<div class="container">
				<div class="row align-items-center justify-content-center">
					<div class="row align-items-center justify-content-center"></div>
					<!-- <div class="col-md-6"><div class="wrapper"  id="slide"><h2 class="heading mb-3 main-title" style="padding-top:130px;">"Gratitude is a powerful catalyst for happiness. Itâ€™s the spark that lights a fire of joy in your soul."</h2></div></div> -->
                    
                    <div class="col-md-3"></div>
					<div class="col-md-6 relative align-self-center form-box-pad">
						<div class="alert alert-danger text-center err-container">
							<span class="err-msg"></span>
						</div>
						<form class="needs-validation bg-white rounded pb_form_v1" id="createUserForm" novalidate>
							
								<h2 class="mb-4 mt-0 text-center">Login</h2>
								<div class="form-group">
									<input type="email" class="form-control pb_height-50 reverse" id="email" placeholder="Email Address..." required>
										<div class="invalid-feedback">
                                    Please enter a valid email.
                                </div>
								</div>
									<div class="form-group">
										<input type="password" class="form-control pb_height-50 reverse" id="password" placeholder="Password..." required>
											<div class="invalid-feedback lengthcheck">
                                        Passwords must be entered
                                        </div>
										</div>
										<div class="form-group">
											<button class="btn btn-success" type="submit">Login</button>
											<div class="col-md-12 mb-3 md-form text-left" style="padding-top:20px">Not a member? 
												<a style="color:green !important;" href="/">Register here.</a>
											</div>
										</div>
									</form>
                                   
                                </div>
                                <div class="col-md-3"></div>
							</div>
						</div>
                    </div>
                </div>
            </div>
	</section>
    <% include partials/footer %><% include partials/scripts %>
					<!-- END section -->
					<!-- <style>
        .wrapper {
   position: relative;
   /* overflow: hidden; */
   width: 100px;
   height: 100px; 
   margin-top:-250px;
   padding-top: 50px;
    /* border: 1px solid black;  */
}

#slide {
   position: absolute;
   left: -800px;
   width: 100%;
   height: 100px;
   
   -webkit-animation: slide 0.5s forwards;
   -webkit-animation-delay: 2s;
   animation: slide 0.5s forwards;
   animation-delay: 2s;
}

@-webkit-keyframes slide {
   100% { left: 0; }
}

@keyframes slide {
   100% { left: 0; }
}
</style> -->
<script type="text/javascript">
      
   $( document ).ready(function() {
      // Handler for .ready() called. 
       $(".err-msg").hide();
       $(".err-container").hide();
      
      
   });
      (function() {
          'use strict';
          window.addEventListener('load', function() {
              // Fetch all the forms we want to apply custom Bootstrap validation styles to
              var forms = document.getElementsByClassName('needs-validation');
              // Loop over them and prevent submission
              var validation = Array.prototype.filter.call(forms, function(form) {
              form.addEventListener('submit', function(event) {
              if (form.checkValidity() === false) {
                 event.preventDefault();
                  
              }
              else{
                  event.preventDefault();
                  var email = $("#email").val();
                  console.log(email);
                  var password = $("#password").val();
                  console.log(password);
                 if( email != "" && password != "" ){
                     $.ajax({
                           url: '/users/login',
                           type: "POST",
                           dataType: "json",
                           data: {
                           email: email,
                           password: password
                           },


                            /**
                            * A function to be called if the request succeeds.
                            */
                            success: function(data, textStatus, jqXHR) {
                                 console.log("id : "+data._id);
                              window.location.assign("/profile/?id="+data._id);
                              
                            
                              
                            },
                           /**
                            * A function to be called if the request fails. 
                            */
                           error : function(error) {
                             
                             console.log(error);
                             if(error.status==500){
                               $(".err-msg").html("Login failed, confirm username and password.");
                                $(".err-msg").show(); 
                                $(".err-container").show();
                             }
                         }

                          
                     });
                  }
            }
              
           form.classList.add('was-validated');
          }, false);
      });
      }, false);
      })();
</script>
    </body>
</html>