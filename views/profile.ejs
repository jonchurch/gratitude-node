<!DOCTYPE html>
<html lang="en">

<head>
    
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title id="title-name"> - GratitudeToday Profile</title>

  <!-- Bootstrap core CSS -->
  <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet">
  <link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/assets/css/resume.min.css" rel="stylesheet">
  <link href="/assets/css/resume.css" rel="stylesheet">
  <link rel="icon" href="/assets/images/favicon.png" type="image/x-icon"/>

</head>

<body id="page-top">

  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
      <span class="d-block d-lg-none" id="name"></span>
      <span class="d-none d-lg-block">
        <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="" alt="">
      </span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" id="account-link" href="#">My Account</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" id="journal-link" href="#">My Journal</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger"id="support-link" href="#">Support</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="/">Logout</a>
        </li>
       
      </ul>
    </div>
  </nav>

  <div class="container-fluid p-0">

    <section class="resume-section p-3 p-lg-5 d-flex align-items-center" id="about">
      <div class="w-100">
        <h1 class="mb-0"><span id="firstname"></span>
          <span class="text-primary"><span id="lastname"></span>
        </h1>
        <div class="subheading mb-5"><span id="location"></span>
               
          <span id="email"></span>
          <form class="needs-validation bg-white rounded pb_form_v1" id="userPostForm" novalidate></form>
            <input type="hidden" id="_id" name="hidden-id" value="">
<div class="alert alert-danger text-center err-container">
							<span class="err-msg"></span>
						</div>
            <div class="form-group">
                <label for="post-label">What are you grateful for today...?</label>
                <textarea class="form-control" id="postMsg" rows="3"></textarea>
                </div>
            </div>
            <div class="form-group">
			    <button class="btn btn-success" type="submit">Post</button>
					
				</div>
			</div>
		</form>
       
      </div>
    </section>

   

    <hr class="m-0">


  </div>

  <% include partials/scripts %>
</body>
<script type = "text/javascript" > 
    
      $(document).ready(function() {
          $(".err-msg").hide();
       $(".err-container").hide();
        var _id= getUrlParameter("id");
      $.ajax({
          url: '/users/'+_id,
          type: "GET",
          dataType: "json",
          data: {id: _id},
            success: function(data, textStatus, jqXHR) {
                   //set first name, lastname, email, avatar 
                   
                    
                     $("#name").html(data.firstname+" "+data.lastname);
                     $("#title-name").html(data.firstname+" "+data.lastname+" - GratitudeToday Profile");
                      
                    
                      $("#firstname").html(data.firstname)
                      $("#lastname").html(data.lastname)
                      $("#email").html(data.email);
                      
                      $("#avatar").attr("src","../"+data.avatar);
                      $("#bio").html(data.bio);
                      $("#location").html(data.location);
                      console.log("location"+data.location);
                      $("#account-link").attr("href","/account/?id="+_id);
                      $("#support-link").attr("href","/support/?id="+_id);
                      $("#journal-link").attr("href","/journal/?id="+_id);
                      
                      $('input[name="hidden-id"]').val(data._id);       
                      emailAddress= data.email;
                  },
                  error: function(jqXHR, textStatus, errorThrown) {
                         if(error.status==500){
                               $(".err-msg").html("Error sending post. Contact support ff error continues");
                                $(".err-msg").show(); 
                                $(".err-container").show();
                             }
                          
                  }
  
            
          });
          
      });
      $( "#account-link" ).click(function() {
        event.preventDefault();
        window.location.assign("/account/?id="+Id)
      });
      $( "#journal-link" ).click(function() {
        event.preventDefault();
        window.location.assign("/journal/?id="+Id)
      });
      $( "#support-link" ).click(function() {
        event.preventDefault();
        window.location.assign("/support/?id="+Id)
      });
      
          
      
    </script>

</html>
